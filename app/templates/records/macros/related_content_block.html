{% macro related_content_block(record) %}
<div class="tna-container">
  <div class="tna-column tna-column--full tna-!--margin-top-l">
    <h2 class="tna-heading-l">Related content</h2>
  </div>
</div>
<div class="tna-container">
  {% if record.has_subjects_enrichment %}
    {% set filtered_subjects = [] %}
    {% for subject_item in record.subjects_enrichment %}
      {% if not subject_item.is_newly_published %}
        {% set _ = filtered_subjects.append(subject_item) %}
      {% endif %}
    {% endfor %}
    
    {% for subject_item in filtered_subjects[:3] %}
      <div class="tna-column tna-column--width-1-3 tna-column--full-small tna-column--full-tiny tna-!--margin-top-m">
        <div class="tna-aside tna-aside--tight tna-background-accent full-height-aside">
          <hgroup class="tna-hgroup-m">
            <p class="tna-hgroup__supertitle">{{ subject_item.type_label }}</p>
          </hgroup>
          
          {% if subject_item.teaser_image %}
            <picture>
              {% if subject_item.teaser_image.webp %}
                <source srcset="{{ subject_item.teaser_image.webp.full_url }}" type="image/webp">
              {% endif %}
              <img 
                src="{{ subject_item.teaser_image.jpeg.full_url }}" 
                alt="{{ subject_item.teaser_image.title|default(subject_item.teaser_image.description)|default('') }}"
                width="{{ subject_item.teaser_image.jpeg.width }}"
                height="{{ subject_item.teaser_image.jpeg.height }}"
                loading="lazy"
              >
            </picture>
          {% endif %}
          
          <hgroup class="tna-hgroup-m">
            <h3 class="tna-hgroup__title"><a href="{{ subject_item.full_url }}">{{ subject_item.title }}</a></h3>
          </hgroup>
          
          <p>{{ subject_item.teaser_text }}</p>
          <p><a href="">See more</a></p>
        </div>
      </div>
    {% endfor %}
  {% endif %}
</div>
{% endmacro %}